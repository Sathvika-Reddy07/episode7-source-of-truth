Version 2: Bug fix applied